var version="v3.1.0 Distributable Release - 27/08/10";var breadcrumbController=function(){if($("tabunderscore")){var b=$("tabunderscore");var a;var c=b;while(c.getPrevious()){if(c.hasClass("breadcrumb")){a=c;a.addClass("moved")}c=c.getPrevious()}if(a){a.inject(b,"after")}}if(!$("tabs")&&!document.body.hasClass("splash")){document.body.addClass("splash")}};var searchController=function(){this.searchForm=$("search");this.searchField=this.searchForm.query;this.focusSearchField=function(){if(this.value==this.title){this.value=""}};this.blurSearchField=function(){if(this.value==""){this.value=this.title}};this.checkSearchEntry=function(){if(this.query.value==""||this.query.value==this.query.title){alert("Please enter some search terms");return false}else{return true}};if(searchForm){this.searchField.onfocus=this.focusSearchField;this.searchField.onblur=this.blurSearchField;this.searchForm.onsubmit=this.checkSearchEntry}};function menuController(a){a=$$("#menu ul li ul");a.each(function(d){var c=d.getParent();var b=new Element("span",{text:"expand","class":"hide_text expander"});if(c.hasClass("static")){b.addClass("open")}else{b.addClass("closed")}b.addEvent("click",individualHandler);c.getFirst("a").setStyle("padding-right","16px");if(Browser.Engine.presto){b.setStyles({width:"0.778em",height:"0.778em",padding:"0.55em","margin-top":"-2.3em"})}b.inject(c.getFirst("a"),"after");d.set("class","unstatic");d.set("slide",{duration:"short"});if(!c.hasClass("static")){d.slide("hide")}})}function individualHandler(){var a=this.getParent("li").getElement("ul");this.toggleClass("open");this.toggleClass("closed");a.slide("toggle");return false}function headTrayController(){var c=$("current-section");if(!c){return}else{c=c.getFirst("a")}c.addClass("dropdown");$("head").setStyle("height","auto");var b=$("tray");var a=new Fx.Slide(b);a.hide();b.setStyle("display","block");b.setStyle("visibility","hidden");a.addEvent("complete",function(){if(!c.hasClass("open")){b.setStyle("visibility","hidden")}});c.addEvent("click",function(){if(!c.hasClass("open")){b.setStyle("visibility","visible")}a.toggle();this.toggleClass("open");return false})}function oversizeContentController(){var d=new Element("p");var c=new Element("a",{text:"View full size",style:"cursor:pointer; font-weight: bold;"});var e=false;var b=$("w4").getSize().x;$$("#content table.tabledata_blue, #content img").each(function(g,f){if(g.getSize().x>b){myExpandTopLink=c.clone().addEvent("click",function(){a.show(g);return false});myExpandTopLink.inject(d.clone().inject(g,"before"));e=true}});if(e){var a=new Overlay({overlayFixedWidth:true,centerOverlay:true})}}function getURLParam(f,c){this.strReturn="";this.strURL=f;if(f.indexOf("?")>-1){var b=f.substr(f.indexOf("?"));var d=b.split("&");for(var a=0;a<d.length;a++){if(d[a].indexOf(c.toLowerCase()+"=")>-1){var e=d[a].split("=");this.strReturn=e[1];break}}}return this.strReturn}function mediaPlayerController(){var a=$$("a");var c=new RegExp("^http://(sydney.edu.au|www.usyd.edu.au|localhost)/video/play.php");var b=new Array();a.each(function(e){if(e.href.match(c)){b.push(e)}});b.each(function(e){if(Browser.Engine.trident&&Browser.Engine.version<=4){}else{e.addEvent("click",function(){var l=getURLParam(e.href,"video");var m=getURLParam(e.href,"poster");var i=getURLParam(e.href,"download");var g=getURLParam(e.href,"widescreen");var h=new Element("div",{id:"mbVideo"});var k=new Element("p");var f=new Element("a",{href:l,text:"Download video (mp4)","class":"download"});var j=new Swiff("http://www.usyd.edu.au/video/player.swf",{id:"swfPlayer",width:480,height:(g=="false"?360:290),params:{wmode:"opaque",bgcolor:"#fff",allowfullscreen:"true",quality:"high",allowScriptAccess:"sameDomain"},vars:{file:l,image:m,autostart:"true"}});j.inject(h);if(i!="false"){f.inject(k);k.inject(h)}d.show(h,{cloneContent:false});return false})}});if(b.length>0){var d=new Overlay({destroyContent:true})}}var Slimbox=(function(){var U=window,am=Browser.Engine.trident4,af,au,T=-1,al,ad,V,ae,ab,N,ah,an={},ag=new Image(),P=new Image(),R,aA,at,aj,Q,aw,S,ay,Z,O,ac,ar,ax,X;U.addEvent("domready",function(){$(document.body).adopt($$(R=new Element("div",{id:"lbOverlay",events:{click:W}}),aA=new Element("div",{id:"lbCenter"}),S=new Element("div",{id:"lbBottomContainer"})).setStyle("display","none"));at=new Element("div",{id:"lbImage"}).injectInside(aA).adopt(aj=new Element("div",{styles:{position:"relative"}}).adopt(Q=new Element("a",{id:"lbPrevLink",href:"#",events:{click:Y}}),aw=new Element("a",{id:"lbNextLink",href:"#",events:{click:av}})));ay=new Element("div",{id:"lbBottom"}).injectInside(S).adopt(new Element("a",{id:"lbCloseLink",href:"#",events:{click:W}}),Z=new Element("div",{id:"lbCaption"}),O=new Element("div",{id:"lbNumber"}),new Element("div",{styles:{clear:"both"}}))});function aa(){var b=U.getScroll(),a=U.getSize();$$(aA,S).setStyle("left",b.x+(a.x/2));if(ae){R.setStyles({left:b.x,top:b.y,width:a.x,height:a.y})}}function ao(b){["object",am?"select":"embed"].forEach(function(c){Array.forEach(document.getElementsByTagName(c),function(d){if(b){d._slimbox=d.style.visibility}d.style.visibility=b?"hidden":d._slimbox})});R.style.display=b?"":"none";var a=b?"addEvent":"removeEvent";U[a]("scroll",aa)[a]("resize",aa);document[a]("keydown",ak)}function ak(a){var b=a.code;return af.closeKeys.contains(b)?W():af.nextKeys.contains(b)?av():af.previousKeys.contains(b)?Y():false}function Y(){return az(ad)}function av(){return az(V)}function az(a){if(a>=0){T=a;al=au[a][0];ad=(T||(af.loop?au.length:0))-1;V=((T+1)%au.length)||(af.loop?0:-1);ai();aA.className="lbLoading";an=new Image();an.onload=ap;an.src=al}return false}function ap(){aA.className="";ax.set(0);at.setStyles({backgroundImage:"url("+al+")",display:""});aj.setStyle("width",an.width);$$(aj,Q,aw).setStyle("height",an.height);Z.set("html",au[T][1]||"");O.set("html",(((au.length>1)&&af.counterText)||"").replace(/{x}/,T+1).replace(/{y}/,au.length));if(ad>=0){ag.src=au[ad][0]}if(V>=0){P.src=au[V][0]}N=at.offsetWidth;ah=at.offsetHeight;var a=Math.max(0,ab-(ah/2)),c=0,b;if(aA.offsetHeight!=ah){c=ar.start({height:ah,top:a})}if(aA.offsetWidth!=N){c=ar.start({width:N,marginLeft:-N/2})}b=function(){S.setStyles({width:N,top:a+ah,marginLeft:-N/2,visibility:"hidden",display:""});ax.start(1)};if(c){ar.chain(b)}else{b()}}function aq(){if(ad>=0){Q.style.display=""}if(V>=0){aw.style.display=""}X.set(-ay.offsetHeight).start(0);S.style.visibility=""}function ai(){an.onload=$empty;an.src=ag.src=P.src=al;ar.cancel();ax.cancel();X.cancel();$$(Q,aw,at,S).setStyle("display","none")}function W(){if(T>=0){ai();T=ad=V=-1;aA.style.display="none";ac.cancel().chain(ao).start(0)}return false}Element.implement({slimbox:function(b,a){$$(this).slimbox(b,a);return this}});Elements.implement({slimbox:function(d,a,b){a=a||function(e){return[e.href,e.title]};b=b||function(){return true};var c=this;c.removeEvents("click").addEvent("click",function(){var e=c.filter(b,this);return Slimbox.open(e.map(a),e.indexOf(this),d)});return c}});return{open:function(a,b,c){af=$extend({loop:false,overlayOpacity:0.8,overlayFadeDuration:400,resizeDuration:400,resizeTransition:false,initialWidth:250,initialHeight:250,imageFadeDuration:400,captionAnimationDuration:400,counterText:"Image {x} of {y}",closeKeys:[27,88,67],previousKeys:[37,80],nextKeys:[39,78]},c||{});ac=new Fx.Tween(R,{property:"opacity",duration:af.overlayFadeDuration});ar=new Fx.Morph(aA,$extend({duration:af.resizeDuration,link:"chain"},af.resizeTransition?{transition:af.resizeTransition}:{}));ax=new Fx.Tween(at,{property:"opacity",duration:af.imageFadeDuration,onComplete:aq});X=new Fx.Tween(ay,{property:"margin-top",duration:af.captionAnimationDuration});if(typeof a=="string"){a=[[a,b]];b=0}ab=U.getScrollTop()+(U.getHeight()/2);N=af.initialWidth;ah=af.initialHeight;aA.setStyles({top:Math.max(0,ab-(ah/2)),width:N,height:ah,marginLeft:-N/2,display:""});ae=am||(R.currentStyle&&(R.currentStyle.position!="fixed"));if(ae){R.style.position="absolute"}ac.set(0).start(af.overlayOpacity);aa();ao(1);au=a;af.loop=af.loop&&(au.length>1);return az(b)}}})();Slimbox.scanPage=function(){$$(document.links).filter(function(a){return a.rel&&a.rel.test(/^lightbox/i)}).slimbox({},null,function(a){return(this==a)||((this.rel.length>8)&&(this.rel==a.rel))})};window.addEvent("domready",function(){breadcrumbController();headTrayController();menuController();oversizeContentController();searchController();mediaPlayerController();Slimbox.scanPage();try{if($chk(JsHook)){$each(JsHook,function(hook,index){eval(hook)})}}catch(e){}});